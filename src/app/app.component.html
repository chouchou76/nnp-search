<!-- <input
  type="text"
  placeholder="T√¨m ki·∫øm..."
  [(ngModel)]="searchQuery"
  (input)="onInputChange($event)"
  (keydown.enter)="onSearch($event)"
  class="search-bar"
/> -->

<header class="main-header">
  <div class="header-container">
    <!-- Logo -->
    <div class="logo">
      <img 
      src="//theme.hstatic.net/1000269461/1000985512/14/logo_medium.png?v=2201" 
      alt="logo N√¥ng Nghi·ªáp Ph·ªë"
      width="222"
      height="36" />
    </div>

    <div class="search-section" (click)="onFocusSearch()" tabindex="0">
  <input
    type="text"
    placeholder="T√¨m ki·∫øm..."
    [(ngModel)]="searchQuery"
    (input)="onInputChange($event)"
    (keydown.enter)="onSearch($event)"
    (focus)="onFocusSearch()"
    (blur)="onBlurSearch()"
    class="search-bar"
  />
  <button (click)="onSearch($event)" class="search-button">
    <img src="https://cdn-icons-png.flaticon.com/512/622/622669.png" alt="search icon" />
  </button>

  <!-- ‚úÖ Dropdown G·ª£i √Ω -->
  <div class="search-dropdown" [ngClass]="{ show: showDropdown }">
    <ng-container *ngIf="searchQuery; else suggestionBlock">
      <!-- <p class="dropdown-title">K·∫øt qu·∫£ t√¨m ki·∫øm cho <span class="highlight">{{ searchQuery }}</span></p> -->
      <div class="dropdown-item" *ngFor="let product of suggestedProducts" (click)="searchQuery = product.name; onSearch($event)">
        <img *ngIf="product.image_urls?.length" [src]="product.image_urls[0]" alt="product" />
        <span class="product-name">{{ product.name }}</span>
      </div>
      <div class="view-all" (click)="onSearchFromDropdown()">
        Xem t·∫•t c·∫£ s·∫£n ph·∫©m c√≥ ch·ª©a <strong>{{ searchQuery }}</strong>
      </div>
    </ng-container>

    <ng-template #suggestionBlock>
      <div *ngIf="topKeywords.length > 0">
        <p class="dropdown-title">üîù T·ª´ kh√≥a n·ªïi b·∫≠t</p>
        <div class="dropdown-item" *ngFor="let keyword of topKeywords" (click)="searchQuery = keyword.keyword; onSearch($event)">
          <span class="product-name">{{ keyword.keyword }} ({{ keyword.count }} l∆∞·ª£t)</span>
        </div>
      </div>

      <div *ngIf="searchHistory.length > 0">
        <p class="dropdown-title">üïò L·ªãch s·ª≠ t√¨m ki·∫øm</p>
        <span class="clear-history-btn" (click)="clearSearchHistory()">Xo√° l·ªãch s·ª≠</span>
        <div class="dropdown-item" *ngFor="let history of searchHistory" (click)="searchQuery = history; onSearch($event)">
          <span class="product-name">{{ history }}</span>
        </div>
      </div>
    </ng-template>
  </div>
</div>

    <!-- Hotline + actions -->
    <div class="header-actions">
      <div class="action-item">
        <img src="https://cdn-icons-png.flaticon.com/512/597/597177.png" alt="phone" />
        <div>
          <p>G·ªçi mua h√†ng</p>
          <strong>0865399086</strong>
        </div>
      </div>
      <div class="action-item">
        <img src="https://cdn-icons-png.flaticon.com/512/684/684908.png" alt="map" />
        <div>
          <p>H·ªá th·ªëng</p>
          <p>c·ª≠a h√†ng</p>
        </div>
      </div>
      <div class="action-item">
        <img src="https://cdn-icons-png.flaticon.com/512/747/747376.png" alt="account" />
        <div>
          <p>T√†i kho·∫£n</p>
          <p>ƒêƒÉng nh·∫≠p</p>
        </div>
      </div>
      <div class="cart-box">
        <img src="https://cdn-icons-png.flaticon.com/512/263/263142.png" alt="cart" />
        <span class="cart-count">0</span>
        <strong>Gi·ªè h√†ng</strong>
      </div>
    </div>
  </div>
</header>

<!-- <div class="search-dropdown" *ngIf="showDropdown">
  <p class="dropdown-title">K·∫øt qu·∫£ t√¨m ki·∫øm cho <span class="highlight">{{ searchQuery }}</span></p>

  <div class="dropdown-item" *ngFor="let product of suggestedProducts">
    <img *ngIf="product.image_urls?.length" [src]="product.image_urls[0]" alt="product" />
    <span class="product-name">{{ product.name }}</span>
  </div>

  <div class="view-all" (click)="onSearchFromDropdown()">
    Xem t·∫•t c·∫£ s·∫£n ph·∫©m c√≥ ch·ª©a <strong>{{ searchQuery }}</strong>
  </div>
</div> -->


<div class="filter-bar">
  <label>
    Gi√° t·ª´:
    <input type="number" [(ngModel)]="minPrice" (input)="applyFilters()" />
  </label>
  <label>
    ƒë·∫øn:
    <input type="number" [(ngModel)]="maxPrice" (input)="applyFilters()" />
  </label>

  <label>
    S·∫Øp x·∫øp:
    <select [(ngModel)]="sortOrder" (change)="applyFilters()">
      <option value="">-- Ch·ªçn --</option>
      <option value="asc">Gi√° tƒÉng d·∫ßn</option>
      <option value="desc">Gi√° gi·∫£m d·∫ßn</option>
    </select>
  </label>
</div>

<div class="product-grid">
  <div class="product-card" *ngFor="let product of paginatedProducts">
    <img *ngIf="product.image_urls.length" [src]="product.image_urls[0]" alt="product image" />
    <p class="product-name">{{ product.name }}</p>
    <p class="product-price">{{ product.price_vnd }}‚Ç´</p>
    <div class="product-add">
      <img src="https://cdn-icons-png.flaticon.com/512/1828/1828817.png" alt="add icon" />
    </div>
  </div>
</div>

<div class="pagination" *ngIf="totalPages > 1">
  <button (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1">‚Äπ</button>
  <button
    *ngFor="let page of [].constructor(totalPages); let i = index"
    (click)="changePage(i + 1)"
    [class.active]="currentPage === i + 1"
  >
    {{ i + 1 }}
  </button>
  <button (click)="changePage(currentPage + 1)" [disabled]="currentPage === totalPages">‚Ä∫</button>
</div>

<p *ngIf="filteredProducts.length === 0">Kh√¥ng c√≥ s·∫£n ph·∫©m n√†o ƒë∆∞·ª£c t√¨m th·∫•y.</p>
